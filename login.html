<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Grand Nord RP ‚Äì Connexion</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* ‚ïê‚ïê‚ïê LOGIN PAGE ‚ïê‚ïê‚ïê */
    body { display:flex; flex-direction:column; min-height:100vh; }

    .login-wrapper {
      position:relative; z-index:1;
      flex:1;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:8rem 2rem 4rem;
    }

    .login-container {
      display:grid;
      grid-template-columns:1fr 1fr;
      max-width:900px;
      width:100%;
      border:1px solid rgba(0,255,200,.18);
      border-radius:16px;
      overflow:hidden;
      backdrop-filter:blur(16px);
      box-shadow:0 30px 80px rgba(0,0,0,.4), 0 0 60px rgba(0,255,200,.05);
    }

    /* LEFT PANEL */
    .login-left {
      background:linear-gradient(160deg,rgba(0,30,50,.85),rgba(0,10,25,.95));
      padding:3.5rem;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      position:relative;
      overflow:hidden;
    }
    .login-left::before {
      content:'';
      position:absolute; top:-100px; left:-100px;
      width:400px; height:400px;
      background:radial-gradient(circle,rgba(0,255,200,.06) 0%,transparent 70%);
      pointer-events:none;
    }
    .login-brand { position:relative; z-index:1; }
    .login-logo {
      font-family:'Cinzel',serif; font-weight:900; font-size:1.3rem;
      letter-spacing:.2em; color:var(--aurora-1);
      text-shadow:0 0 20px rgba(0,255,200,.4);
      text-decoration:none; display:block; margin-bottom:2.5rem;
    }
    .login-tagline {
      font-family:'Cinzel',serif; font-size:1.8rem; font-weight:600;
      color:var(--ice); line-height:1.2; margin-bottom:1.2rem;
    }
    .login-tagline span {
      background:linear-gradient(90deg,var(--aurora-1),var(--aurora-2));
      -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text;
    }
    .login-desc { font-size:.88rem; color:rgba(224,247,255,.55); line-height:1.8; }

    .login-perks { position:relative; z-index:1; margin-top:2.5rem; }
    .perk-item {
      display:flex; align-items:center; gap:.8rem;
      padding:.7rem 0; border-bottom:1px solid rgba(255,255,255,.06);
      font-size:.84rem; color:rgba(224,247,255,.6);
    }
    .perk-item:last-child { border-bottom:none; }
    .perk-icon { font-size:1.1rem; flex-shrink:0; }

    .login-quote {
      position:relative; z-index:1;
      margin-top:auto; padding-top:2rem;
      font-style:italic;
      font-size:.82rem; color:rgba(168,216,234,.4);
      border-top:1px solid rgba(255,255,255,.06);
    }

    /* RIGHT PANEL */
    .login-right {
      background:rgba(0,10,22,.9);
      padding:3.5rem;
      display:flex;
      flex-direction:column;
      justify-content:center;
    }
    .login-tabs {
      display:flex; gap:0;
      margin-bottom:2.5rem;
      border:1px solid rgba(0,255,200,.15);
      border-radius:6px; overflow:hidden;
    }
    .login-tab {
      flex:1; padding:.7rem; text-align:center;
      font-family:'Cinzel',serif; font-size:.78rem; letter-spacing:.15em; text-transform:uppercase;
      cursor:pointer; border:none; background:transparent;
      color:rgba(168,216,234,.5);
      transition:all .25s;
    }
    .login-tab.active {
      background:rgba(0,255,200,.1);
      color:var(--aurora-1);
    }

    .login-panel { display:none; }
    .login-panel.active { display:block; }

    .login-panel h2 {
      font-family:'Cinzel',serif; font-size:1.4rem; color:var(--ice);
      margin-bottom:.5rem;
    }
    .login-panel .sub {
      font-size:.84rem; color:rgba(168,216,234,.45); margin-bottom:2rem; line-height:1.6;
    }

    /* Discord OAuth button */
    .btn-discord-oauth {
      display:flex; align-items:center; justify-content:center; gap:.8rem;
      width:100%; padding:1rem;
      background:linear-gradient(135deg,#5865F2,#7289da);
      border:none; border-radius:8px; cursor:pointer;
      font-family:'Cinzel',serif; font-size:.85rem; letter-spacing:.15em; text-transform:uppercase;
      color:white; font-weight:600; text-decoration:none;
      transition:transform .2s,box-shadow .3s;
      box-shadow:0 0 30px rgba(88,101,242,.25);
      margin-bottom:1.5rem;
    }
    .btn-discord-oauth:hover { transform:translateY(-2px); box-shadow:0 0 50px rgba(88,101,242,.45); }
    .btn-discord-oauth .d-icon { font-size:1.3rem; }

    .or-divider {
      display:flex; align-items:center; gap:1rem;
      margin:1.2rem 0;
      font-size:.72rem; letter-spacing:.15em; text-transform:uppercase;
      color:rgba(168,216,234,.3);
    }
    .or-divider::before, .or-divider::after {
      content:''; flex:1; height:1px; background:rgba(255,255,255,.07);
    }

    .form-group input { background:rgba(0,20,40,.7); }
    .form-forgot {
      display:block; text-align:right; font-size:.76rem;
      color:rgba(168,216,234,.4); text-decoration:none; margin-top:.4rem; margin-bottom:1.5rem;
      transition:color .2s;
    }
    .form-forgot:hover { color:var(--aurora-1); }

    .btn-login {
      width:100%; padding:1rem;
      background:linear-gradient(135deg,var(--aurora-1),var(--aurora-2));
      border:none; border-radius:6px; cursor:pointer;
      font-family:'Cinzel',serif; font-size:.85rem; letter-spacing:.15em; text-transform:uppercase;
      color:var(--deep); font-weight:700;
      transition:transform .2s,box-shadow .3s;
      box-shadow:0 0 25px rgba(0,255,200,.25);
    }
    .btn-login:hover { transform:translateY(-2px); box-shadow:0 0 40px rgba(0,255,200,.4); }

    .login-footer-note {
      margin-top:1.5rem; text-align:center;
      font-size:.78rem; color:rgba(168,216,234,.35); line-height:1.6;
    }
    .login-footer-note a { color:var(--aurora-1); text-decoration:none; }

    /* ‚ïê‚ïê‚ïê MEMBER PANEL (after login) ‚ïê‚ïê‚ïê */
    .member-panel {
      display:none;
      max-width:900px; width:100%;
    }
    .member-panel.show { display:block; }

    .member-header {
      border:1px solid rgba(0,255,200,.15);
      border-radius:12px; padding:2rem 2.5rem;
      background:rgba(0,15,30,.6); backdrop-filter:blur(12px);
      display:flex; align-items:center; gap:2rem;
      margin-bottom:2rem;
    }
    .member-avatar {
      width:70px; height:70px; border-radius:50%;
      border:2px solid var(--aurora-1);
      display:flex; align-items:center; justify-content:center;
      font-size:2rem;
      background:rgba(0,255,200,.05);
      box-shadow:0 0 20px rgba(0,255,200,.2);
      flex-shrink:0;
    }
    .member-info h2 { font-family:'Cinzel',serif; font-size:1.3rem; color:var(--ice); }
    .member-info p { font-size:.84rem; color:rgba(168,216,234,.5); margin-top:.3rem; }
    .member-badges { display:flex; gap:.5rem; margin-top:.6rem; flex-wrap:wrap; }
    .member-badge {
      font-size:.65rem; letter-spacing:.12em; text-transform:uppercase;
      padding:.25rem .7rem; border-radius:12px;
    }
    .badge-wl { background:rgba(0,255,200,.1); border:1px solid rgba(0,255,200,.3); color:var(--aurora-1); }
    .badge-police { background:rgba(77,184,255,.1); border:1px solid rgba(77,184,255,.3); color:#4db8ff; }
    .badge-vet { background:rgba(240,165,0,.1); border:1px solid rgba(240,165,0,.3); color:#f0a500; }

    .member-stats {
      display:grid; grid-template-columns:repeat(4,1fr); gap:1rem; margin-bottom:2rem;
    }
    .member-stat {
      border:1px solid rgba(0,255,200,.1); border-radius:8px; padding:1.5rem;
      background:rgba(0,15,30,.4); text-align:center;
    }
    .member-stat-val { font-family:'Cinzel',serif; font-size:1.6rem; font-weight:900; color:var(--aurora-1); }
    .member-stat-lbl { font-size:.7rem; letter-spacing:.15em; text-transform:uppercase; color:rgba(168,216,234,.45); margin-top:.3rem; }

    .member-actions {
      display:grid; grid-template-columns:repeat(3,1fr); gap:1rem;
    }
    .action-card {
      border:1px solid rgba(0,255,200,.1); border-radius:10px; padding:1.5rem;
      background:rgba(0,15,30,.4); text-align:center;
      transition:border-color .3s,transform .3s; cursor:pointer;
    }
    .action-card:hover { border-color:rgba(0,255,200,.35); transform:translateY(-3px); }
    .action-icon { font-size:2rem; margin-bottom:.7rem; }
    .action-title { font-family:'Cinzel',serif; font-size:.9rem; color:var(--ice); margin-bottom:.4rem; }
    .action-desc { font-size:.78rem; color:rgba(224,247,255,.45); line-height:1.6; }

    .btn-logout {
      display:inline-flex; align-items:center; gap:.5rem; margin-left:auto;
      font-size:.75rem; letter-spacing:.12em; text-transform:uppercase;
      color:rgba(168,216,234,.4); background:transparent; border:none; cursor:pointer;
      padding:.5rem; transition:color .3s;
    }
    .btn-logout:hover { color:#ff6b6b; }

    @media (max-width:750px) {
      .login-container { grid-template-columns:1fr; }
      .login-left { display:none; }
      .member-stats { grid-template-columns:repeat(2,1fr); }
      .member-actions { grid-template-columns:1fr; }
    }
  </style>
</head>
<body>
  <canvas id="aurora-canvas"></canvas>
  <div class="stars" id="stars"></div>
  <div id="snowflakes"></div>

  <nav>
    <a class="nav-logo" href="index.html">GRAND NORD RP</a>
    <ul class="nav-links">
      <li><a href="index.html">Accueil</a></li>
      <li><a href="factions.html">Factions</a></li>
      <li><a href="economie.html">√âconomie</a></li>
      <li><a href="candidature.html">Candidature</a></li>
      <li><a href="news.html">News</a></li>
      <li><a href="login.html" class="nav-discord active">Espace membre</a></li>
      <li id="nav-admin-link" style="display:none"><a href="admin.html" class="nav-admin">‚öô Admin</a></li>
    </ul>
  </nav>
  <style>
    .nav-admin {
      color: #f0a500 !important;
      border: 1px solid rgba(240,165,0,.35);
      border-radius: 4px;
      padding: .3rem .8rem !important;
      font-family: 'Cinzel', serif;
      font-size: .72rem !important;
      letter-spacing: .15em;
      transition: all .2s;
    }
    .nav-admin:hover {
      background: rgba(240,165,0,.1);
      border-color: rgba(240,165,0,.7);
      color: #f0c040 !important;
    }
  </style>

  <div class="login-wrapper">

    <!-- LOGIN / REGISTER FORMS -->
    <div class="login-container" id="auth-container">
      <!-- LEFT -->
      <div class="login-left">
        <div class="login-brand">
          <a class="login-logo" href="index.html">GRAND NORD RP</a>
          <h2 class="login-tagline">Ton espace<br><span>membre</span></h2>
          <p class="login-desc">Acc√®de √† ton profil, suis ta candidature, consulte tes statistiques et g√®re ton personnage depuis cet espace.</p>
        </div>
        <div class="login-perks">
          <div class="perk-item"><span class="perk-icon">üìä</span>Suivi de ta candidature en temps r√©el</div>
          <div class="perk-item"><span class="perk-icon">üë§</span>Gestion de ton personnage RP</div>
          <div class="perk-item"><span class="perk-icon">üèÜ</span>Statistiques et classements</div>
          <div class="perk-item"><span class="perk-icon">üîî</span>Notifications exclusives membres</div>
          <div class="perk-item"><span class="perk-icon">üé´</span>Acc√®s aux tickets de support</div>
        </div>
        <div class="login-quote">"Le froid r√©v√®le qui tu es vraiment."</div>
      </div>

      <!-- RIGHT -->
      <div class="login-right">
        <div class="login-tabs">
          <button class="login-tab active" onclick="switchTab('login')">Connexion</button>
          <button class="login-tab" onclick="switchTab('register')">Inscription</button>
        </div>

        <!-- LOGIN PANEL -->
        <div class="login-panel active" id="panel-login">
          <h2>Bon retour</h2>
          <p class="sub">Connecte-toi pour acc√©der √† ton espace membre.</p>

          <div class="or-divider">connexion</div>

          <div id="login-msg" style="display:none;padding:.75rem 1rem;border-radius:6px;border:1px solid;font-size:.83rem;margin-bottom:1rem;"></div>

          <form onsubmit="doLogin(event)">
            <div class="form-group">
              <label>E-mail ou pseudo</label>
              <input type="text" id="login-email" placeholder="ton@email.com ou TonPseudo" autocomplete="username">
            </div>
            <div class="form-group">
              <label>Mot de passe</label>
              <input type="password" id="login-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password">
            </div>
            <a href="#" class="form-forgot">Mot de passe oubli√© ?</a>
            <button type="submit" class="btn-login">Se connecter</button>
          </form>

          <p class="login-footer-note">
            Pas encore de compte ? <a onclick="switchTab('register')" href="#">S'inscrire</a><br>
            Connexion r√©serv√©e aux joueurs whitelist√©s.
          </p>
        </div>

        <!-- REGISTER PANEL -->
        <div class="login-panel" id="panel-register">
          <h2>Cr√©er un compte</h2>
          <p class="sub">Rejoins la communaut√© Grand Nord RP.</p>

          <div id="reg-msg" style="display:none;padding:.75rem 1rem;border-radius:6px;border:1px solid;font-size:.83rem;margin-bottom:1rem;"></div>

          <form onsubmit="doRegister(event)">
            <div class="form-group">
              <label>Pseudo</label>
              <input type="text" id="reg-pseudo" placeholder="TonPseudo" autocomplete="username">
            </div>
            <div class="form-group">
              <label>Adresse e-mail</label>
              <input type="email" id="reg-email" placeholder="ton@email.com" autocomplete="email">
            </div>
            <div class="form-group">
              <label>Mot de passe</label>
              <input type="password" id="reg-password" placeholder="8 caract√®res minimum" autocomplete="new-password">
            </div>
            <div class="form-group">
              <label>Confirmer le mot de passe</label>
              <input type="password" id="reg-confirm" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="new-password">
            </div>
            <button type="submit" class="btn-login" style="margin-top:.5rem;">Cr√©er mon compte</button>
          </form>

          <p class="login-footer-note">
            D√©j√† un compte ? <a onclick="switchTab('login')" href="#">Se connecter</a>
          </p>
        </div>
      </div>
    </div>

    <!-- MEMBER PANEL (shown after login) -->
    <div class="member-panel" id="member-panel">
      <div class="member-header">
        <div class="member-avatar" id="mp-avatar">üê∫</div>
        <div class="member-info">
          <h2 id="mp-name">Bienvenue</h2>
          <p id="mp-info">Membre ¬∑ Serveur : Grand Nord RP</p>
          <div class="member-badges" id="mp-badges"></div>
        </div>
        <button class="btn-logout" onclick="logout()">‚Ü© D√©connexion</button>
      </div>

      <div class="member-stats">
        <div class="member-stat"><div class="member-stat-val">‚Äî</div><div class="member-stat-lbl">Heures de jeu</div></div>
        <div class="member-stat"><div class="member-stat-val">‚Äî</div><div class="member-stat-lbl">Sessions RP</div></div>
        <div class="member-stat"><div class="member-stat-val">‚Äî</div><div class="member-stat-lbl">GNC en poche</div></div>
        <div class="member-stat"><div class="member-stat-val">‚Äî</div><div class="member-stat-lbl">Grade actuel</div></div>
      </div>

      <div class="member-actions">
        <div class="action-card" id="action-admin" style="display:none" onclick="window.location.href='admin.html'" style="border-color:rgba(240,165,0,.3);cursor:pointer;">
          <div class="action-icon">‚öôÔ∏è</div>
          <div class="action-title" style="color:#f0a500;">Panneau Admin</div>
          <div class="action-desc">Acc√©dez au panel de gestion du serveur.</div>
        </div>
        <div class="action-card">
          <div class="action-icon">üë§</div>
          <div class="action-title">Mon personnage</div>
          <div class="action-desc">Consulte et modifie la fiche de ton personnage RP.</div>
        </div>
        <div class="action-card">
          <div class="action-icon">üìã</div>
          <div class="action-title">Ma candidature</div>
          <div class="action-desc">Suis le statut de ta whitelist et les retours du staff.</div>
        </div>
        <div class="action-card">
          <div class="action-icon">üé´</div>
          <div class="action-title">Support</div>
          <div class="action-desc">Ouvre un ticket de support pour signaler un probl√®me.</div>
        </div>
        <div class="action-card">
          <div class="action-icon">üèÜ</div>
          <div class="action-title">Classements</div>
          <div class="action-desc">Vois o√π tu te places parmi les joueurs actifs.</div>
        </div>
        <div class="action-card">
          <div class="action-icon">üîî</div>
          <div class="action-title">Notifications</div>
          <div class="action-desc">Aucune nouvelle notification pour le moment.</div>
        </div>
        <div class="action-card">
          <div class="action-icon">üîë</div>
          <div class="action-title">Param√®tres</div>
          <div class="action-desc">Modifie tes pr√©f√©rences et informations de compte.</div>
        </div>
      </div>
    </div>

  </div>

  <footer>
    <div class="footer-logo">GRAND NORD RP</div>
    <ul class="footer-links">
      <li><a href="index.html">Accueil</a></li>
      <li><a href="factions.html">Factions</a></li>
      <li><a href="candidature.html">Candidature</a></li>
      <li><a href="news.html">News</a></li>
    </ul>
    <p class="footer-copy">¬© 2025 Grand Nord RP ¬∑ FiveM</p>
  </footer>

  <script src="shared.js"></script>
  <script>
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    //  SYST√àME D'AUTHENTIFICATION GRAND NORD RP
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

    // Compte ROOT par d√©faut (cr√©√© si aucun compte n'existe)
    const ROOT_ACCOUNT = {
      id: 'root-001',
      pseudo: 'RootAdmin',
      email: 'root@grandnord.rp',
      password: 'GrandNord2025!',
      role: 'owner',
      avatar: 'üëë',
      joinDate: new Date().toISOString().split('T')[0],
      active: true,
      isRoot: true
    };

    // ‚îÄ‚îÄ‚îÄ Helpers stockage ‚îÄ‚îÄ‚îÄ
    function getAccounts() {
      try {
        const data = JSON.parse(localStorage.getItem('gnrp-accounts') || 'null');
        if (!data || data.length === 0) {
          // Initialise avec le compte ROOT
          const accounts = [ROOT_ACCOUNT];
          localStorage.setItem('gnrp-accounts', JSON.stringify(accounts));
          return accounts;
        }
        return data;
      } catch(e) {
        return [ROOT_ACCOUNT];
      }
    }

    function saveAccounts(accounts) {
      localStorage.setItem('gnrp-accounts', JSON.stringify(accounts));
    }

    function getSession() {
      try { return JSON.parse(localStorage.getItem('gnrp-session') || 'null'); } catch(e) { return null; }
    }

    function saveSession(user) {
      localStorage.setItem('gnrp-session', JSON.stringify(user));
    }

    function clearSession() {
      localStorage.removeItem('gnrp-session');
    }

    // ‚îÄ‚îÄ‚îÄ Affichage erreur/succ√®s ‚îÄ‚îÄ‚îÄ
    function showMsg(el, msg, isError) {
      el.textContent = msg;
      el.style.display = 'block';
      el.style.background = isError ? 'rgba(255,107,107,.1)' : 'rgba(0,255,200,.1)';
      el.style.borderColor = isError ? 'rgba(255,107,107,.3)' : 'rgba(0,255,200,.3)';
      el.style.color = isError ? '#ff6b6b' : '#00ffc8';
    }

    // ‚îÄ‚îÄ‚îÄ Connexion ‚îÄ‚îÄ‚îÄ
    function doLogin(e) {
      e.preventDefault();
      const email    = document.getElementById('login-email').value.trim();
      const password = document.getElementById('login-password').value;
      const msgEl    = document.getElementById('login-msg');

      if (!email || !password) {
        showMsg(msgEl, 'Veuillez remplir tous les champs.', true);
        return;
      }

      const accounts = getAccounts();
      const user = accounts.find(a =>
        (a.email.toLowerCase() === email.toLowerCase() || a.pseudo.toLowerCase() === email.toLowerCase())
        && a.password === password
        && a.active !== false
      );

      if (!user) {
        showMsg(msgEl, 'Identifiants incorrects ou compte d√©sactiv√©.', true);
        return;
      }

      saveSession(user);
      showMemberPanel(user);
    }

    // ‚îÄ‚îÄ‚îÄ Inscription ‚îÄ‚îÄ‚îÄ
    function doRegister(e) {
      e.preventDefault();
      const pseudo   = document.getElementById('reg-pseudo').value.trim();
      const email    = document.getElementById('reg-email').value.trim();
      const password = document.getElementById('reg-password').value;
      const confirm  = document.getElementById('reg-confirm').value;
      const msgEl    = document.getElementById('reg-msg');

      if (!pseudo || !email || !password || !confirm) {
        showMsg(msgEl, 'Tous les champs sont obligatoires.', true); return;
      }
      if (password.length < 8) {
        showMsg(msgEl, 'Le mot de passe doit contenir au moins 8 caract√®res.', true); return;
      }
      if (password !== confirm) {
        showMsg(msgEl, 'Les mots de passe ne correspondent pas.', true); return;
      }

      const accounts = getAccounts();
      if (accounts.find(a => a.email.toLowerCase() === email.toLowerCase())) {
        showMsg(msgEl, 'Cet e-mail est d√©j√† utilis√©.', true); return;
      }
      if (accounts.find(a => a.pseudo.toLowerCase() === pseudo.toLowerCase())) {
        showMsg(msgEl, 'Ce pseudo est d√©j√† pris.', true); return;
      }

      const newUser = {
        id: 'user-' + Date.now(),
        pseudo, email, password,
        role: 'member',
        avatar: 'üê∫',
        joinDate: new Date().toISOString().split('T')[0],
        active: true,
        isRoot: false
      };
      accounts.push(newUser);
      saveAccounts(accounts);
      saveSession(newUser);
      showMemberPanel(newUser);
    }

    // ‚îÄ‚îÄ‚îÄ Afficher le panel membre ‚îÄ‚îÄ‚îÄ
    function showMemberPanel(user) {
      document.getElementById('auth-container').style.display = 'none';
      const panel = document.getElementById('member-panel');
      panel.classList.add('show');

      // Remplir les infos
      document.getElementById('mp-avatar').textContent  = user.avatar || 'üê∫';
      document.getElementById('mp-name').textContent    = 'Bienvenue, ' + user.pseudo;
      document.getElementById('mp-info').textContent    = 'Membre depuis le ' + user.joinDate + ' ¬∑ Serveur : Grand Nord RP';

      // Badges
      const badgesEl = document.getElementById('mp-badges');
      badgesEl.innerHTML = '';
      const roleBadge = document.createElement('span');
      roleBadge.className = 'member-badge ' + (user.role === 'owner' ? 'badge-vet' : user.role === 'admin' ? 'badge-police' : 'badge-wl');
      roleBadge.textContent = user.role === 'owner' ? 'üëë Owner' : user.role === 'admin' ? '‚ö° Admin' : user.role === 'modo' ? 'üõ°Ô∏è Mod√©rateur' : '‚úì Membre';
      badgesEl.appendChild(roleBadge);

      // Afficher ou masquer lien admin dans la nav
      const adminLink = document.getElementById('nav-admin-link');
      if (adminLink && (user.role === 'owner' || user.role === 'admin')) {
        adminLink.style.display = '';
      }

      // Afficher bouton Admin dans les actions si owner/admin
      const adminAction = document.getElementById('action-admin');
      if (adminAction) {
        adminAction.style.display = (user.role === 'owner' || user.role === 'admin') ? '' : 'none';
      }
    }

    // ‚îÄ‚îÄ‚îÄ D√©connexion ‚îÄ‚îÄ‚îÄ
    function logout() {
      clearSession();
      document.getElementById('auth-container').style.display = 'grid';
      document.getElementById('member-panel').classList.remove('show');
      document.getElementById('login-email').value = '';
      document.getElementById('login-password').value = '';
      document.getElementById('nav-admin-link').style.display = 'none';
    }

    // ‚îÄ‚îÄ‚îÄ Tabs ‚îÄ‚îÄ‚îÄ
    function switchTab(tab) {
      document.querySelectorAll('.login-tab').forEach((t,i) => {
        t.classList.toggle('active', (tab==='login' && i===0)||(tab==='register' && i===1));
      });
      document.getElementById('panel-login').classList.toggle('active', tab==='login');
      document.getElementById('panel-register').classList.toggle('active', tab==='register');
    }

    // ‚îÄ‚îÄ‚îÄ Init ‚îÄ‚îÄ‚îÄ
    document.addEventListener('DOMContentLoaded', function() {
      // Initialise les comptes si n√©cessaire
      getAccounts();

      // V√©rifie si une session existe
      const session = getSession();
      if (session) {
        // V√©rifie que le compte existe toujours et est actif
        const accounts = getAccounts();
        const freshUser = accounts.find(a => a.id === session.id && a.active !== false);
        if (freshUser) {
          showMemberPanel(freshUser);
          return;
        } else {
          clearSession();
        }
      }

      // Affiche le nav admin si session active
      try {
        const s = JSON.parse(localStorage.getItem('gnrp-session') || 'null');
        if (s && (s.role === 'admin' || s.role === 'owner')) {
          document.getElementById('nav-admin-link').style.display = '';
        }
      } catch(e) {}
    });
  </script>
</body>
</html>
